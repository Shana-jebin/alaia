{% extends 'user_profile/base_profile.html' %}
{% load static %}

{% block title %}
  Addresses - ALAIA
{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'user_profile/profile.css' %}" />
  <link rel="stylesheet" href="{% static 'user_profile/address-management.css' %}" />
{% endblock %}

{% block profile_content %}
  <div class="account-inner">
    {% if messages %}
  {% for message in messages %}
    <div class="toast-message {{ message.tags }}">
      {{ message }}
    </div>
  {% endfor %}
{% endif %}


    <div class="header">
      <div class="header-text">
        <h1>Addresses</h1>
        <p>Manage your shipping and billing addresses.</p>
      </div>
     {% if addresses %}
<a href="{% url 'add_address' %}" class="add-address-btn">
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
    </svg>
    Add New Address
</a>
{% endif %}

    </div>
   {% if addresses %}
  <div class="addresses-grid">
    {% for address in addresses %}
      <div class="address-card">
        {% if address.is_default %}
          <span class="default-badge">Default</span>
        {% endif %}

        <h3>{{ address.full_name }}</h3>

        <div class="address-details">
          <p>{{ address.address_line1 }}</p>

          {% if address.address_line2 %}
            <p>{{ address.address_line2 }}</p>
          {% endif %}

          <p>{{ address.city }}, {{ address.state }} {{ address.postal_code }}</p>
          <p>{{ address.country }}</p>
        </div>

        <div class="phone">{{ address.phone }}</div>

        <div class="actions">

          {% if not address.is_default %}
          <form method="POST" action="{% url 'set_default_address' address.id %}">
            {% csrf_token %}
            <button type="submit" class="action-btn set-default-btn">
              Set as Default
            </button>
          </form>
          {% endif %}

        <a href="{% url 'edit_address' address.id %}" class="action-btn icon-btn" title="Edit">
    <svg viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2"
         stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 20h9"/>
        <path d="M16.5 3.5a2.1 2.1 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"/>
    </svg>
</a>

<form method="POST" action="{% url 'delete_address' address.id %}" style="display:inline;">
    {% csrf_token %}
    <button type="submit" class="action-btn delete icon-btn" title="Delete">
        <svg viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2"
             stroke-linecap="round" stroke-linejoin="round">
            <polyline points="3 6 5 6 21 6"/>
            <path d="M19 6l-1 14H6L5 6"/>
            <path d="M10 11v6"/>
            <path d="M14 11v6"/>
            <path d="M9 6V4h6v2"/>
        </svg>
    </button>
</form>


        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="empty-state">
    <h2>No saved addresses yet</h2>
    <p>Add your first address to start shopping smoothly.</p>
    <a href="{% url 'add_address' %}" class="add-address-btn">
      + Add New Address
    </a>
  </div>
{% endif %}

  </div>
{% endblock %}
{% block extra_js %}
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const navItems = document.querySelectorAll('.nav-item')
    
      navItems.forEach((item) => {
        item.addEventListener('click', function (e) {
          e.preventDefault()
    
          // Remove active class from all items
          navItems.forEach((nav) => nav.classList.remove('active'))
    
          // Add active class to clicked item
          this.classList.add('active')
        })
      })
    
      // Add click handlers to Set as Default buttons
     
    
      // Add click handler to Sign Out button
      const signOutBtn = document.querySelector('.sign-out')
      signOutBtn.addEventListener('click', function () {
        if (confirm('Are you sure you want to sign out?')) {
          alert('Signing out...')
          // Add your sign out logic here
        }
      })
    })



setTimeout(function() {
    const toast = document.querySelector('.toast-message');
    if(toast){
        toast.style.opacity = "0";
        toast.style.transform = "translateY(-10px)";
        setTimeout(()=> toast.remove(), 400);
    }
}, 3000);



  </script>
{% endblock %}
